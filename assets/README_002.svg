<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1356px" preserveAspectRatio="none" style="width:4413px;height:1356px;background:#FFFFFF;" version="1.1" viewBox="0 0 4413 1356" width="4413px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="123" x="2144" y="29.9659">Forward Function</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="162" x2="162" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="252" x2="252" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="373" x2="373" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="532" x2="532" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="687" x2="687" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="831" x2="831" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1046" x2="1046" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1303" x2="1303" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1618" x2="1618" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1890" x2="1890" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2096" x2="2096" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2380" x2="2380" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2651" x2="2651" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2923" x2="2923" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3202" x2="3202" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3496" x2="3496" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3734" x2="3734" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3906" x2="3906" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="4148" x2="4148" y1="124.1358" y2="1273.0223"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="4358" x2="4358" y1="124.1358" y2="1273.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="5" y="120.0339">input_vectors</text><ellipse cx="53" cy="53.5679" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M53,61.5679 L53,88.5679 M40,69.5679 L66,69.5679 M53,88.5679 L40,103.5679 M53,88.5679 L66,103.5679 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="5" y="1286.9883">input_vectors</text><ellipse cx="53" cy="1299.5903" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M53,1307.5903 L53,1334.5903 M40,1315.5903 L66,1315.5903 M53,1334.5903 L40,1349.5903 M53,1334.5903 L66,1349.5903 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="111" y="120.0339">memory_input</text><ellipse cx="162.5" cy="53.5679" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M162.5,61.5679 L162.5,88.5679 M149.5,69.5679 L175.5,69.5679 M162.5,88.5679 L149.5,103.5679 M162.5,88.5679 L175.5,103.5679 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="111" y="1286.9883">memory_input</text><ellipse cx="162.5" cy="1299.5903" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M162.5,1307.5903 L162.5,1334.5903 M149.5,1315.5903 L175.5,1315.5903 M162.5,1334.5903 L149.5,1349.5903 M162.5,1334.5903 L175.5,1349.5903 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="224" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="231" y="112.0339">device</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="224" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="231" y="1293.9883">device</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="291" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="298" y="112.0339">search(memory_input)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="291" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="298" y="1293.9883">search(memory_input)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="465" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="472" y="112.0339">indices, distances</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="465" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="472" y="1293.9883">indices, distances</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="609" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="616" y="112.0339">get_all_embeddings()</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="609" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="616" y="1293.9883">get_all_embeddings()</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="776" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="783" y="112.0339">search_results</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="776" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="783" y="1293.9883">search_results</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="299" x="897" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="285" x="904" y="112.0339">concatenate(input_vectors, search_results)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="299" x="897" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="285" x="904" y="1293.9883">concatenate(input_vectors, search_results)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="1206" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="1213" y="112.0339">self.fc(concatenated_input)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="195" x="1206" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="1213" y="1293.9883">self.fc(concatenated_input)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="415" x="1411" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401" x="1418" y="112.0339">self.gpt2_model.transformer(inputs_embeds=input_vectors)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="415" x="1411" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401" x="1418" y="1293.9883">self.gpt2_model.transformer(inputs_embeds=input_vectors)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108" x="1836" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="1843" y="112.0339">hidden_states</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108" x="1836" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="1843" y="1293.9883">hidden_states</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="284" x="1954" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="270" x="1961" y="112.0339">self.gpt2_model.lm_head(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="284" x="1954" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="270" x="1961" y="1293.9883">self.gpt2_model.lm_head(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="264" x="2248" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="250" x="2255" y="112.0339">self.fc_storable_vector(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="264" x="2248" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="250" x="2255" y="1293.9883">self.fc_storable_vector(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="258" x="2522" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="244" x="2529" y="112.0339">self.fc_store_decision(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="258" x="2522" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="244" x="2529" y="1293.9883">self.fc_store_decision(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="266" x="2790" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="252" x="2797" y="112.0339">self.fc_delete_decision(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="266" x="2790" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="252" x="2797" y="1293.9883">self.fc_delete_decision(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="272" x="3066" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="258" x="3073" y="112.0339">self.fc_deletable_vector(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="272" x="3066" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="258" x="3073" y="1293.9883">self.fc_deletable_vector(hidden_states)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="296" x="3348" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="282" x="3355" y="112.0339">self.memory.add(storable_vector_to_store)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="296" x="3348" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="282" x="3355" y="1293.9883">self.memory.add(storable_vector_to_store)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="3654" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="3661" y="112.0339">calculate L2 distances</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="3654" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="3661" y="1293.9883">calculate L2 distances</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162" x="3825" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="3832" y="112.0339">threshold comparison</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="162" x="3825" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="3832" y="1293.9883">threshold comparison</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="302" x="3997" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="288" x="4004" y="112.0339">self.memory.remove(indices_to_delete_flat)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="302" x="3997" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="288" x="4004" y="1293.9883">self.memory.remove(indices_to_delete_flat)</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="4309" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="4316" y="112.0339">return logits</text><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="4309" y="1272.0223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="4316" y="1293.9883">return logits</text><path d="M58,139.1358 L58,184.1358 L304,184.1358 L304,149.1358 L294,139.1358 L58,139.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M294,139.1358 L294,149.1358 L304,149.1358 L294,139.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="64" y="158.0328">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="64" y="175.7389">(batch_size, seq_len, embedding_dim)</text><path d="M167,194.5479 L167,239.5479 L413,239.5479 L413,204.5479 L403,194.5479 L167,194.5479 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M403,194.5479 L403,204.5479 L413,204.5479 L403,194.5479 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="173" y="213.4449">Tensor (optional):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="173" y="231.1509">(batch_size, seq_len, embedding_dim)</text><polygon fill="#181818" points="240.5,246.9599,250.5,250.9599,240.5,254.9599,244.5,250.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="53" x2="246.5" y1="250.9599" y2="250.9599"/><polygon fill="#181818" points="240.5,260.9599,250.5,264.9599,240.5,268.9599,244.5,264.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162.5" x2="246.5" y1="264.9599" y2="264.9599"/><polygon fill="#181818" points="361,274.9599,371,278.9599,361,282.9599,365,278.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="252.5" x2="367" y1="278.9599" y2="278.9599"/><polygon fill="#181818" points="520,288.9599,530,292.9599,520,296.9599,524,292.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="373" x2="526" y1="292.9599" y2="292.9599"/><path d="M537,305.9599 L537,368.9599 L866,368.9599 L866,315.9599 L856,305.9599 L537,305.9599 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M856,305.9599 L856,315.9599 L866,315.9599 L856,305.9599 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="543" y="324.8569">Tensors:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="543" y="342.5629">indices: (batch_size, seq_len, num_search_results)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="543" y="360.2689">distances: (batch_size, seq_len, num_search_results)</text><polygon fill="#181818" points="675.5,376.0779,685.5,380.0779,675.5,384.0779,679.5,380.0779" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="532" x2="681.5" y1="380.0779" y2="380.0779"/><path d="M692,393.0779 L692,438.0779 L904,438.0779 L904,403.0779 L894,393.0779 L692,393.0779 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M894,393.0779 L894,403.0779 L904,403.0779 L894,393.0779 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="698" y="411.975">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="698" y="429.681">(memory_size, embedding_dim)</text><polygon fill="#181818" points="819.5,445.49,829.5,449.49,819.5,453.49,823.5,449.49" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="825.5" y1="449.49" y2="449.49"/><path d="M836,462.49 L836,507.49 L1098,507.49 L1098,472.49 L1088,462.49 L836,462.49 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1088,462.49 L1088,472.49 L1098,472.49 L1088,462.49 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="842" y="481.387">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="842" y="499.093">(batch_size, seq_len, search_results_dim)</text><polygon fill="#181818" points="1034.5,514.902,1044.5,518.902,1034.5,522.902,1038.5,518.902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="831.5" x2="1040.5" y1="518.902" y2="518.902"/><path d="M1051,531.902 L1051,576.902 L1424,576.902 L1424,541.902 L1414,531.902 L1051,531.902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1414,531.902 L1414,541.902 L1424,541.902 L1414,531.902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1057" y="550.799">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="352" x="1057" y="568.505">(batch_size, seq_len, embedding_dim + search_results_dim)</text><polygon fill="#181818" points="1291.5,584.314,1301.5,588.314,1291.5,592.314,1295.5,588.314" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.5" x2="1297.5" y1="588.314" y2="588.314"/><path d="M1308,601.314 L1308,646.314 L1554,646.314 L1554,611.314 L1544,601.314 L1308,601.314 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1544,601.314 L1544,611.314 L1554,611.314 L1544,601.314 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1314" y="620.2111">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="1314" y="637.9171">(batch_size, seq_len, embedding_dim)</text><polygon fill="#181818" points="1606.5,653.7261,1616.5,657.7261,1606.5,661.7261,1610.5,657.7261" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1303.5" x2="1612.5" y1="657.7261" y2="657.7261"/><polygon fill="#181818" points="1878,667.7261,1888,671.7261,1878,675.7261,1882,671.7261" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1618.5" x2="1884" y1="671.7261" y2="671.7261"/><path d="M1895,684.7261 L1895,729.7261 L2141,729.7261 L2141,694.7261 L2131,684.7261 L1895,684.7261 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2131,684.7261 L2131,694.7261 L2141,694.7261 L2131,684.7261 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="1901" y="703.6231">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="1901" y="721.3291">(batch_size, seq_len, embedding_dim)</text><polygon fill="#181818" points="2084,737.1381,2094,741.1381,2084,745.1381,2088,741.1381" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1890" x2="2090" y1="741.1381" y2="741.1381"/><path d="M2101,754.1381 L2101,799.1381 L2313,799.1381 L2313,764.1381 L2303,754.1381 L2101,754.1381 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2303,754.1381 L2303,764.1381 L2313,764.1381 L2303,754.1381 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="2107" y="773.0351">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="2107" y="790.7411">(batch_size, seq_len, vocab_size)</text><polygon fill="#181818" points="2368,806.5501,2378,810.5501,2368,814.5501,2372,810.5501" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1890" x2="2374" y1="810.5501" y2="810.5501"/><path d="M2385,823.5501 L2385,868.5501 L2613,868.5501 L2613,833.5501 L2603,823.5501 L2385,823.5501 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2603,823.5501 L2603,833.5501 L2613,833.5501 L2603,823.5501 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="2391" y="842.4472">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="2391" y="860.1532">(batch_size, seq_len, memory_dim)</text><polygon fill="#181818" points="2639,875.9622,2649,879.9622,2639,883.9622,2643,879.9622" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1890" x2="2645" y1="879.9622" y2="879.9622"/><path d="M2656,892.9622 L2656,937.9622 L2811,937.9622 L2811,902.9622 L2801,892.9622 L2656,892.9622 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2801,892.9622 L2801,902.9622 L2811,902.9622 L2801,892.9622 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="2662" y="911.8592">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="2662" y="929.5652">(batch_size, seq_len, 1)</text><polygon fill="#181818" points="2911,945.3742,2921,949.3742,2911,953.3742,2915,949.3742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1890" x2="2917" y1="949.3742" y2="949.3742"/><path d="M2928,962.3742 L2928,1007.3742 L3195,1007.3742 L3195,972.3742 L3185,962.3742 L2928,962.3742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3185,962.3742 L3185,972.3742 L3195,972.3742 L3185,962.3742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="2934" y="981.2712">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="2934" y="998.9772">(batch_size, seq_len, num_search_results)</text><polygon fill="#181818" points="3190,1014.7862,3200,1018.7862,3190,1022.7862,3194,1018.7862" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1890" x2="3196" y1="1018.7862" y2="1018.7862"/><path d="M3207,1031.7862 L3207,1076.7862 L3435,1076.7862 L3435,1041.7862 L3425,1031.7862 L3207,1031.7862 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3425,1031.7862 L3425,1041.7862 L3435,1041.7862 L3425,1031.7862 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="3213" y="1050.6833">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="3213" y="1068.3893">(batch_size, seq_len, memory_dim)</text><polygon fill="#181818" points="3484,1084.1983,3494,1088.1983,3484,1092.1983,3488,1088.1983" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2380" x2="3490" y1="1088.1983" y2="1088.1983"/><polygon fill="#181818" points="3722.5,1098.1983,3732.5,1102.1983,3722.5,1106.1983,3726.5,1102.1983" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3202" x2="3728.5" y1="1102.1983" y2="1102.1983"/><path d="M3739,1115.1983 L3739,1160.1983 L3955,1160.1983 L3955,1125.1983 L3945,1115.1983 L3739,1115.1983 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3945,1115.1983 L3945,1125.1983 L3955,1125.1983 L3945,1115.1983 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="3745" y="1134.0953">Tensor:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="3745" y="1151.8013">(batch_size, num_search_results)</text><polygon fill="#181818" points="3894,1167.6103,3904,1171.6103,3894,1175.6103,3898,1171.6103" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3734.5" x2="3900" y1="1171.6103" y2="1171.6103"/><path d="M3911,1184.6103 L3911,1229.6103 L4127,1229.6103 L4127,1194.6103 L4117,1184.6103 L3911,1184.6103 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M4117,1184.6103 L4117,1194.6103 L4127,1194.6103 L4117,1184.6103 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="3917" y="1203.5073">Tensor (bool):</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="3917" y="1221.2133">(batch_size, num_search_results)</text><polygon fill="#181818" points="4136,1237.0223,4146,1241.0223,4136,1245.0223,4140,1241.0223" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="3906" x2="4142" y1="1241.0223" y2="1241.0223"/><polygon fill="#181818" points="4346,1251.0223,4356,1255.0223,4346,1259.0223,4350,1255.0223" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2096" x2="4352" y1="1255.0223" y2="1255.0223"/><!--SRC=[hLR1ZjiW4Btp5TGdMyr6wXvNQY_jhbIfnwfNHCmuHiAG0axLVdsn8GvWnyvsUuZip3o6Ds-6mPPR0VX5wLzKC_pIozfo9H5wnw3X4l1ta4RfqkvOXIr-ZmjS5kx1XjUgc61Vddzy_VoC2mPdNaE14AsjqhZWyjHRSeRXdoamDJYnN60TT4h_9gDlHCK6XAIoW3K_jXQh9ek00yKdzrOUgArROlWVs643Fua0kSFG7O0nBe-4yQv281aU0kPXaoqlKN6fJeCWL5J_i47253zy2ZAXUAl8Z8AApb8OeBfkonXPZSfu1_8F_31WkMHETBF3Z1jBfNkDa4I3wONDaarzbspDa6E8zdGZMTbt95bjAhTeslarowv29Pun_oDOGeKWaxQczFcdnYojp9dqHf3IyxfPiZH2L8eBxRcqPatRUneqNP0pIhs-uhMIDRKWtQzCcYmFvZMBu2mqU4fv0V3AS-NcmNeQyoryAWP4is_gSkxtt9kQgDxEAL_jRvW0Kv28o_5a7qcd68YzrLIQHkaEj9VP-Dum7nFHFT48788Qj63pExMSCP347HeRJcjYoN9DVM_8DmcqdBFeI0kKbGdKPoZKaS-wFHYtIPrLJG-ZyHv6hZB6QKiF0eBCIumoI7uGC-ysnp0ZxbGjS0J2eER6tHAtA5uH2mmZvpR13tVoSfK4kquiWsJCSkysjVK9lyLrez0vPedj_oXrrZ8HKO_VKyRA34IiydqGBYZ6Y0SZbFCAqvkAkXSkEVpjCRkpnIEP3Fb1YrqtyrklGXp3Sx6jWxLAC7S7T2UgkL7IZxEBWrmT6QD5oFNBwQ3KmbVJEi6baFCYQFSu3pVV-AKow1_QjN6g-Yfuo5G8FwLy90ssrp8ChW0UB2ICihy0]--></g></svg>
